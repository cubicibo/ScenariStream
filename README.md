# ScenariStream
Scenarist MUI+Elementary Stream <-> SUP, MNU, TextST conversion tool.

## Brief
ScenariStream is a Python utility to perform bidirectional conversion between proprietary Scenarist project files (MUI+xES) and open format data streams like SUP/PGS, MNU/IGS and TextST.

In other words, this tool converts SUP (subtitles) or IGS (interactive menu) files generated with open source projects to Scenarist BD assets that can be imported in Scenarist authoring suite. Similarly, data streams generated with Scenarist BD can be converted to their respective open format, to be usable with tools like BDEdit, tsMuxer, etc! The conversion is bijective: all data and timestamps are preserved[^1].

[^1]: As long as the duration of the stream is below 13:15:21,858 for SUP and IGS, this should not be an issue anyway.

## Limitations
- Timestamp wrap-around is not fully tested, due to the lack of samples.
- TextST support is only unidirectional, from .TextST to TES+MUI assets. TextST files must be generated by SubtitleEdit
- The project has safeguards to prevent the usage of MUI assets that are not "Text" (TES) or "Graphic" (IES, PES). Support for other MUI assets (audio or video) may be added later.

## Usage:
### Command line client
This utility requires Python3.9 or more.
`python3 client.py PARAMETERS -o output_file`<br>

#### Parameters
`-s --stream <file>` – Input raw stream file (SUP-PGS, MNU-IGS or TextST).[^1]<br>
`-x --xes <file>` – Input Scenarist Elementary Stream file (PES, IES or TES).[^1]<br>
`-o --output <file>` – Output file with extension. The format is inferred from the extension. For xES+MUI output, only the xES file should be specified, the MUI file is generated aside.<br>
`-m --mui <file>` – Input Scenarist MUI file, required if .mui file has a different name or location to the .pes file.<br>
`-t --textst` – Flag for TextST conversion.

[^1]: mutually exclusive as they specify the input type.

#### Example
The command below converts a .SUP file to PES+MUI assets.<br>
`python3 client.py -s subtitles.sup -o ./project/subtitles.pes`<br>
The existing ./project folder will be populated with the output of the program: subtitles.pes and subtitles.pes.mui.

### Python library
ScenariStream may also be installed as a Python library:<br>
`python3 -m pip install git+https://github.com/cubicibo/ScenariStream.git` (`@v0.x.y` for a specific release)

Internal classes are:
- `EsMuiStream` to parse ES+MUI assets.
- `StreamFile` to parse generic SUP, MNU files.
- `TextSTFile` which derives from `StreamFile` to parse TextST files.
The EsMuiStream class contains the necessary methods to perform the format conversion.

### Note
The user has the responisiblity to pick the proper extension when converting to Scenarist xES+MUI format. The output extension should be .PES (.IES, .TES) when converting from .SUP (.MNU, .TextST, respectively). Furthermore, ScenariStream does not check the compliancy of the data in the stream; it only performs a conversion.
